
&НаКлиенте
Процедура Команда1(Команда)
	ЗаполнитьДеревоФич("C:\Users\Alehin Sasha\Desktop\п1");
КонецПроцедуры

&НаКлиенте
Процедура ЗаполнитьДеревоФич(КаталогФич)
	ПодготовитьФичи();
	
	ДополнительныеПараметры = Новый Структура;
	
	ДополнительныеПараметры.Вставить("КаталогПоиска", КаталогФич + "\");
	
	НачатьПоискФайлов(Новый ОписаниеОповещения("ЗаполнитьДеревоФичЗавершение", ЭтотОбъект, ДополнительныеПараметры), КаталогФич, "*.feature", Истина);
КонецПроцедуры

&НаКлиенте
Процедура ЗаполнитьДеревоФичЗавершение(НайденныеФайлы, ДополнительныеПараметры) Экспорт
	Если ЗначениеЗаполнено(НайденныеФайлы) Тогда
		Для Каждого НайденныйФайл Из НайденныеФайлы Цикл
			ДобавитьОписаниеФичи(Параметры.Фичи, НайденныйФайл);
			ОпределитьРодительскиеКаталогиФичи(Параметры.Фичи, НайденныйФайл, ДополнительныеПараметры);
		КонецЦикла;
	КонецЕсли;	
КонецПроцедуры

&НаКлиенте
Процедура ПодготовитьФичи()
	Параметры.Фичи = Новый Структура;
КонецПроцедуры

&НаКлиенте
Процедура ДобавитьОписаниеФичи(Фичи, НайденныйФайл)
	Фичи.Вставить("Имя", НайденныйФайл.Имя);
	Фичи.Вставить("ИмяБезРасширения", НайденныйФайл.ИмяБезРасширения);
	Фичи.Вставить("ПолноеИмя", НайденныйФайл.ПолноеИмя);
	Фичи.Вставить("Путь", НайденныйФайл.Путь);
	Фичи.Вставить("Расширение", НайденныйФайл.Расширение);
	Фичи.Вставить("Родитель", Неопределено);
КонецПроцедуры

&НаКлиенте
Процедура ОпределитьРодительскиеКаталогиФичи(Фичи, НайденныйФайл, ДополнительныеПараметры)
	СтрокаРодительскихКаталогов = СтрЗаменить(НайденныйФайл.Путь, ДополнительныеПараметры.КаталогПоиска, "");

КонецПроцедуры
